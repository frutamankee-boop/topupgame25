<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Sky25 Store</title>
  <style>
    body {font-family: Arial, sans-serif; margin:0; padding:0; background:#000; color:white; overflow-x:hidden;}
    .parallax-bg {position:fixed; top:0; left:0; width:100%; height:100%; z-index:-2; display:flex;}
    .parallax-bg .left,.parallax-bg .right {flex:1; background-size:cover; background-position:center; background-repeat:no-repeat; animation:slowZoom 30s ease-in-out infinite alternate;}
    .parallax-bg .left {background-image:url('sky.jpg');}
    .parallax-bg .right {background-image:url('roblox.jpg');}
    @keyframes slowZoom {from{transform:scale(1);} to{transform:scale(1.1);}}
    .overlay {position:fixed; top:0; left:0; width:100%; height:100%; background:linear-gradient(to right, rgba(0,0,0,0.7), rgba(0,0,0,0.1), rgba(0,0,0,0.7)); backdrop-filter:blur(12px); z-index:-1;}
    header {background:rgba(44,62,80,0.95); padding:15px; text-align:center; border-bottom:2px solid #3498db; position:sticky; top:0; z-index:1000;}
    header.sticky {box-shadow:0 4px 10px rgba(0,0,0,0.5);}
    h1{margin:0;font-size:1.8rem;} p{margin:5px 0;}
    nav ul{list-style:none;padding:0;margin:0;display:flex;justify-content:center;gap:20px;}
    nav ul li a{text-decoration:none;color:#fff;font-weight:bold;padding:8px 15px;border-radius:5px;transition:.3s;}
    nav ul li a:hover, nav ul li a.active{background:#3498db;}
    .container{max-width:500px;margin:30px auto;background:rgba(255,255,255,0.1);padding:20px;border-radius:10px;box-shadow:0 4px 15px rgba(0,0,0,0.5);}
    input,select,button{width:100%;padding:10px;margin:8px 0;border-radius:6px;border:none;font-size:14px;}
    button{background:#3498db;color:#fff;cursor:pointer;transition:.3s;} button:hover{background:#2980b9;}
    .google-btn{background:#db4437;} .google-btn:hover{background:#c1351d;}
    footer{background:rgba(44,62,80,0.9);color:#fff;text-align:center;padding:10px;border-top:2px solid #3498db;position:fixed;left:0;bottom:0;width:100%;}
    #mainContent{display:none;}
  </style>
</head>
<body>
  <!-- Background -->
  <div class="parallax-bg"><div class="left"></div><div class="right"></div></div>
  <div class="overlay"></div>

  <!-- Header -->
  <header>
    <h1>Sky25 Store</h1>
    <p>Top Up Sky & Roblox dengan mudah</p>
    <nav id="navbar">
      <ul>
        <li><a href="#home">Home</a></li>
        <li><a href="#" onclick="showSection('skySection')">Top Up Sky</a></li>
        <li><a href="#" onclick="showSection('robloxSection')">Top Up Roblox</a></li>
        <li><a href="#riwayat">Riwayat</a></li>
        <li><a href="#" onclick="logout()">Logout</a></li>
      </ul>
    </nav>
  </header>

  <!-- Login/Register -->
  <div class="container" id="authContainer">
    <h2 id="authTitle">Login</h2>
    <input type="email" id="email" placeholder="Email" required>
    <input type="password" id="password" placeholder="Password" required>
    <button id="authBtn">Login</button>
    <button class="google-btn" id="googleLoginBtn">Login dengan Google</button>
    <p id="toggleAuth">Belum punya akun? <a href="#" onclick="toggleAuth()">Daftar</a></p>
  </div>

  <!-- Main Content -->
  <div class="container" id="mainContent">
    <h2 id="home">Selamat datang di Sky25 Store!</h2>
    <p>Pilih menu di atas untuk mulai top up.</p>

    <div id="skySection" style="display:none;">
      <h3>Top Up Sky</h3>
      <input type="text" id="skyId" placeholder="Player ID">
      <input type="text" id="skyContact" placeholder="WhatsApp / Discord / Facebook">
      <select id="skyItem">
        <option value="60 Candle - Rp15.000">60 Candle - Rp15.000</option>
        <option value="150 Candle - Rp35.000">150 Candle - Rp35.000</option>
      </select>
      <button onclick="topUpSky()">Top Up Sky</button>
    </div>

    <div id="robloxSection" style="display:none;">
      <h3>Top Up Roblox</h3>
      <input type="text" id="robloxId" placeholder="Username Roblox">
      <input type="password" id="robloxPassword" placeholder="Password Roblox">
      <input type="text" id="robloxContact" placeholder="WhatsApp / Discord / Facebook">
      <select id="robloxItem">
        <option value="80 Robux - Rp12.000">80 Robux - Rp12.000</option>
        <option value="400 Robux - Rp50.000">400 Robux - Rp50.000</option>
      </select>
      <button onclick="topUpRoblox()">Top Up Roblox</button>
    </div>

    <h3 id="riwayat">Riwayat</h3>
    <ul id="riwayatList"></ul>
  </div>

  <footer><p>Â© 2025 Sky25 Store</p></footer>

  <script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
  import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, signOut, GoogleAuthProvider, signInWithPopup, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js";
  import { getFirestore, collection, addDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyBbDU0baVjNVQ7fTqQOWk-veGyU4zxyWxM",
      authDomain: "topupgame-f508b.firebaseapp.com",
      projectId: "topupgame-f508b",
      storageBucket: "topupgame-f508b.firebasestorage.app",
      messagingSenderId: "180478528774",
      appId: "1:180478528774:web:80936f95f3785d8938e287"
    };

    const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);
  const provider = new GoogleAuthProvider();
  const db = getFirestore(app);

    const adminEmails = ["frutamankee@gmail.com"]; // daftar admin

    let isLoginMode = true;
    function toggleAuth(){ isLoginMode=!isLoginMode;
      authTitle.innerText=isLoginMode?"Login":"Daftar";
      authBtn.innerText=isLoginMode?"Login":"Daftar";
      toggleAuth.innerHTML=isLoginMode
        ? 'Belum punya akun? <a href="#" onclick="toggleAuth()">Daftar</a>'
        : 'Sudah punya akun? <a href="#" onclick="toggleAuth()">Login</a>';
    }
    window.toggleAuth=toggleAuth;

    authBtn.addEventListener("click", async ()=>{
      const emailVal=email.value, passwordVal=password.value;
      try{
        if(isLoginMode) await signInWithEmailAndPassword(auth,emailVal,passwordVal);
        else await createUserWithEmailAndPassword(auth,emailVal,passwordVal);

        if(adminEmails.includes(emailVal)){
          window.location.href="admin.html"; // admin redirect
        } else {
          alert(isLoginMode?"Login sukses!":"Pendaftaran sukses!");
          showMain();
        }
      } catch(e){ alert(e.message); }
    });

    googleLoginBtn.addEventListener("click", async ()=>{
      try{ 
        const result = await signInWithPopup(auth,provider); 
        if(adminEmails.includes(result.user.email)){
          window.location.href="admin.html";
        } else {
          alert("Login Google sukses!");
          showMain();
        }
      }catch(e){ alert(e.message); }
    });

    function showMain(){ authContainer.style.display="none"; mainContent.style.display="block"; }
    function logout(){ signOut(auth); } window.logout=logout;
    function showSection(id){ skySection.style.display="none"; robloxSection.style.display="none"; if(id){document.getElementById(id).style.display="block";} }
    window.showSection=showSection;
    // Cek status login saat halaman dimuat
    onAuthStateChanged(auth, (user) => {
      if (user) {
        showMain();
      } else {
        authContainer.style.display = "block";
        mainContent.style.display = "none";
      }
    });
    // Fungsi Top Up Sky
    async function topUpSky() {
      const id = document.getElementById('skyId').value;
      const contact = document.getElementById('skyContact').value;
      const item = document.getElementById('skyItem').value;
      if (!id || !contact) {
        alert('Mohon isi semua data untuk Top Up Sky!');
        return;
      }
      try {
        await addDoc(collection(db, "topup_sky"), {
          playerId: id,
          contact: contact,
          item: item,
          createdAt: serverTimestamp(),
          user: auth.currentUser ? auth.currentUser.email : null
        });
  alert("Top Up Sky berhasil dikirim ke server!\n\nTerimakasih melakukan order, Pesananmu akan segera diproses. Tim kami akan menghubungi segera untuk keperluan kode verifikasi jika diperlukan.");
      } catch (e) {
        alert("Gagal mengirim data: " + e.message);
      }
    }
    window.topUpSky = topUpSky;

    // Fungsi Top Up Roblox
    async function topUpRoblox() {
      const id = document.getElementById('robloxId').value;
      const password = document.getElementById('robloxPassword').value;
      const contact = document.getElementById('robloxContact').value;
      const item = document.getElementById('robloxItem').value;
      if (!id || !password || !contact) {
        alert('Mohon isi semua data untuk Top Up Roblox!');
        return;
      }
      try {
        await addDoc(collection(db, "topup_roblox"), {
          username: id,
          password: password,
          contact: contact,
          item: item,
          createdAt: serverTimestamp(),
          user: auth.currentUser ? auth.currentUser.email : null
        });
        alert("Top Up Roblox berhasil dikirim ke server!\n\nTerimakasih melakukan order, Pesananmu akan segera diproses. Tim kami akan menghubungi segera untuk keperluan kode verifikasi jika diperlukan.");
      } catch (e) {
        console.error("Gagal mengirim data:", e);
        alert("Gagal mengirim data: " + e.message + "\nSilakan coba lagi atau hubungi admin.");
      }
    }
    window.topUpRoblox = topUpRoblox;
  </script>
</body>
</html>
